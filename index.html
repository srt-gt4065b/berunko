<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ë² ë£½ì½” ì–‘ë§ - ë§ˆë¼í† ë„ˆë¥¼ ìœ„í•œ ì„ íƒ</title>
    <style>
        /* [ìŠ¤íƒ€ì¼ ì •ì˜ êµ¬ì—­] */
        :root {
            --primary-color: #ff6b00;
            --text-color: #333;
            --bg-color: #f5f5f5;
            --admin-bg: #2c3e50; /* ê´€ë¦¬ì í…Œë§ˆìƒ‰ */
            --admin-accent: #3498db;
        }

        body {
            font-family: 'Apple SD Gothic Neo', 'Malgun Gothic', sans-serif;
            margin: 0;
            padding: 0;
            background-color: var(--bg-color);
            color: var(--text-color);
        }

        /* ê³µí†µ í—¤ë” */
        header {
            background-color: white;
            padding: 20px;
            text-align: center;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
            position: sticky;
            top: 0;
            z-index: 100;
        }

        header h1 {
            margin: 0;
            color: var(--primary-color);
            font-size: 1.5rem;
            cursor: pointer;
        }

        .container {
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            padding-bottom: 80px;
        }

        .hidden { display: none !important; }

        /* ì‡¼í•‘ëª° ë©”ì¸ */
        .product-list {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 20px;
            min-height: 200px; /* ë¡œë”© ë©”ì‹œì§€ ê³µê°„ í™•ë³´ */
        }

        .product-card {
            background: white;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 2px 5px rgba(0,0,0,0.05);
            transition: transform 0.2s;
            cursor: pointer;
            text-align: center;
            padding-bottom: 15px;
            position: relative; /* ì‚­ì œ ë²„íŠ¼ ìœ„ì¹˜ìš© */
        }
        .product-card:hover { transform: translateY(-5px); }

        .product-img {
            width: 100%;
            height: 150px;
            object-fit: cover;
            background-color: #eee;
        }

        .product-name { font-weight: bold; margin: 10px 0 5px; }
        .product-price { color: var(--primary-color); font-weight: bold; }

        /* ë²„íŠ¼ ë° ì…ë ¥ í¼ */
        .btn {
            background-color: var(--primary-color);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 1rem;
            width: 100%;
            margin-top: 10px;
        }
        .btn:hover { opacity: 0.9; }
        .btn-secondary { background-color: #999; margin-top: 10px; }
        .btn-small { width: auto; padding: 5px 10px; font-size: 0.8rem; margin: 0; }
        .btn-danger { background-color: #e74c3c; color: white; }
        .btn-edit { background-color: #f39c12; color: white; margin-right: 5px;}

        /* ì¼ë°˜ ë·° ìŠ¤íƒ€ì¼ */
        .detail-view, .order-view, .success-view {
            background: white; padding: 20px; border-radius: 10px;
        }
        .form-group { margin-bottom: 15px; }
        .form-group label { display: block; margin-bottom: 5px; font-weight: bold; }
        .form-group input, .form-group select {
            width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 5px; box-sizing: border-box;
        }
        .detail-img { width: 100%; max-width: 300px; display: block; margin: 0 auto 20px; border-radius: 10px; }
        .price-summary { background-color: #fff8f0; padding: 15px; border-radius: 5px; margin: 20px 0; border: 1px solid #ffe0b2; }
        .bank-info { background-color: #e8f4fd; padding: 15px; border-radius: 5px; margin-bottom: 20px; color: #0056b3; font-weight: bold; text-align: center; }

        /* --- [ê´€ë¦¬ì ì „ìš© ìŠ¤íƒ€ì¼] --- */
        .admin-view {
            background-color: white; padding: 20px; border-radius: 10px; border: 2px solid var(--admin-bg);
        }
        .admin-nav {
            display: flex; gap: 10px; margin-bottom: 20px;
        }
        .admin-nav button {
            flex: 1; padding: 10px; border: none; background: #eee; cursor: pointer; border-radius: 5px;
            font-weight: bold;
        }
        .admin-nav button.active {
            background: var(--admin-bg); color: white;
        }

        /* í†µê³„ ëŒ€ì‹œë³´ë“œ */
        .stats-container {
            display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-bottom: 20px;
        }
        .stat-card {
            background: #f8f9fa; padding: 15px; border-radius: 8px; text-align: center; border: 1px solid #ddd;
        }
        .stat-value { font-size: 1.5rem; font-weight: bold; color: var(--admin-bg); margin: 5px 0; }
        .stat-label { font-size: 0.9rem; color: #666; }

        /* ìƒí’ˆ ê´€ë¦¬ í…Œì´ë¸” */
        .admin-product-item {
            display: flex; align-items: center; justify-content: space-between;
            padding: 10px; border-bottom: 1px solid #eee;
        }
        .admin-product-info { display: flex; align-items: center; gap: 10px; }
        .admin-product-thumb { width: 40px; height: 40px; border-radius: 4px; object-fit: cover; }

        /* ì£¼ë¬¸ ë‚´ì—­ ìŠ¤íƒ€ì¼ */
        .order-item { border: 1px solid #ddd; padding: 15px; margin-bottom: 10px; border-radius: 8px; }
        .order-header { display: flex; justify-content: space-between; margin-bottom: 10px; font-size: 0.9rem; color: #666; }
        .status-badge { padding: 3px 8px; border-radius: 10px; font-size: 0.8rem; }
        .status-pending { background: #ffe0b2; color: #e65100; }
        .status-completed { background: #c8e6c9; color: #2e7d32; }

        /* Footer ìŠ¤íƒ€ì¼ ê°œì„  */
        footer { 
            margin-top: 50px; 
            padding: 30px 20px;
            background-color: #f8f8f8;
            border-top: 1px solid #ddd;
        }
        
        .footer-content {
            max-width: 800px;
            margin: 0 auto;
            text-align: center;
        }
        
        .admin-btn {
            background-color: var(--admin-bg);
            color: white;
            border: none;
            padding: 12px 30px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 0.9rem;
            margin-bottom: 15px;
            transition: background-color 0.3s;
        }
        
        .admin-btn:hover {
            background-color: #34495e;
        }
        
        .copyright {
            color: #aaa;
            font-size: 0.8rem;
            margin-top: 10px;
        }
        
        /* ë¡œë”©/ì—ëŸ¬ ë©”ì‹œì§€ ìŠ¤íƒ€ì¼ */
        .status-msg { text-align: center; width: 100%; padding: 20px; color: #666; }
        .error-msg { color: #e74c3c; font-weight: bold; }

        /* ì¥ë°”êµ¬ë‹ˆ ê´€ë ¨ ìŠ¤íƒ€ì¼ */
        .cart-floating-btn {
            position: fixed;
            bottom: 30px;
            right: 30px;
            width: 60px;
            height: 60px;
            background-color: var(--primary-color);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 4px 12px rgba(0,0,0,0.3);
            cursor: pointer;
            z-index: 1000;
            transition: transform 0.2s;
        }
        .cart-floating-btn:hover {
            transform: scale(1.1);
        }
        .cart-badge {
            position: absolute;
            top: -5px;
            right: -5px;
            background-color: #e74c3c;
            color: white;
            border-radius: 50%;
            width: 24px;
            height: 24px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.8rem;
            font-weight: bold;
        }
        .cart-item {
            display: flex;
            gap: 15px;
            padding: 15px;
            border-bottom: 1px solid #eee;
            align-items: center;
        }
        .cart-item-img {
            width: 80px;
            height: 80px;
            object-fit: cover;
            border-radius: 8px;
        }
        .cart-item-info {
            flex: 1;
        }
        .cart-item-name {
            font-weight: bold;
            margin-bottom: 5px;
        }
        .cart-item-option {
            font-size: 0.9rem;
            color: #666;
            margin-bottom: 5px;
        }
        .cart-item-price {
            color: var(--primary-color);
            font-weight: bold;
        }
        .cart-qty-control {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        .cart-qty-btn {
            width: 25px;
            height: 25px;
            border: 1px solid #ddd;
            background: white;
            border-radius: 4px;
            cursor: pointer;
            font-size: 1rem;
        }
        .cart-qty-btn:hover {
            background: #f5f5f5;
        }
        .cart-remove-btn {
            background: none;
            border: none;
            color: #e74c3c;
            cursor: pointer;
            font-size: 1.2rem;
            padding: 5px;
        }
        .cart-summary {
            position: sticky;
            bottom: 0;
            background: white;
            padding: 20px;
            border-top: 2px solid #eee;
            box-shadow: 0 -2px 10px rgba(0,0,0,0.1);
        }
        .cart-total {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
            font-size: 1.2rem;
        }
        .cart-total-amount {
            color: var(--primary-color);
            font-weight: bold;
            font-size: 1.5rem;
        }
        .empty-cart {
            text-align: center;
            padding: 60px 20px;
            color: #999;
        }
        .empty-cart-icon {
            font-size: 4rem;
            margin-bottom: 20px;
        }
    </style>
</head>
<body>

    <header>
        <div style="display: flex; justify-content: space-between; align-items: center; max-width: 800px; margin: 0 auto;">
            <h1 onclick="goHome()" style="margin: 0; cursor: pointer;">ğŸ§¦ ë² ë£½ì½” ì–‘ë§</h1>
            <div onclick="showCart()" style="position: relative; cursor: pointer; font-size: 1.8rem;">
                ğŸ›’
                <span id="cart-badge" class="cart-badge hidden">0</span>
            </div>
        </div>
    </header>

    <div class="container">
        
        <!-- [í™”ë©´ 1] ë©”ì¸ í˜ì´ì§€ (ìƒí’ˆ ëª©ë¡) -->
        <div id="main-page">
            <!-- [ì¶”ê°€ë¨] ìƒë‹¨ ë©”ì¸ ë°°ë„ˆ ì´ë¯¸ì§€ -->
            <div style="margin-bottom: 40px; text-align: center;">
                <img src="https://placehold.co/800x350/ff6b00/ffffff?text=VERUNCO+RUNNING&font=roboto" 
                     style="width: 100%; max-height: 350px; object-fit: cover; border-radius: 15px; box-shadow: 0 4px 15px rgba(255, 107, 0, 0.2);" 
                     alt="ë©”ì¸ ë°°ë„ˆ">
            </div>

            <h2 style="text-align:center; margin-bottom:30px;">ê¸°ë¡ ë‹¨ì¶•ì„ ìœ„í•œ ìµœê³ ì˜ ì„ íƒ</h2>
            
            <!-- [ë³€ê²½ë¨] DB ë¡œë”© ì „ì—ë„ ë³´ì—¬ì§ˆ 'ìƒ˜í”Œ ë°ì´í„°'ë¥¼ í•˜ë“œì½”ë”©í•´ë‘  -->
            <div id="product-list" class="product-list">
                <!-- ìƒ˜í”Œ 1 -->
                <div class="product-card" onclick="showProductDetail('static-1')">
                    <img src="https://placehold.co/300x300/orange/white?text=Speed" class="product-img">
                    <div style="padding:10px;">
                        <div class="product-name">ë² ë£½ì½” ìŠ¤í”¼ë“œ (ì´ˆê²½ëŸ‰)</div>
                        <div class="product-price">12,000ì›</div>
                    </div>
                </div>
                <!-- ìƒ˜í”Œ 2 -->
                <div class="product-card" onclick="showProductDetail('static-2')">
                    <img src="https://placehold.co/300x300/navy/white?text=Marathon" class="product-img">
                    <div style="padding:10px;">
                        <div class="product-name">ë² ë£½ì½” ë§ˆë¼í†¤ í”„ë¡œ</div>
                        <div class="product-price">15,000ì›</div>
                    </div>
                </div>
                <!-- ìƒ˜í”Œ 3 -->
                <div class="product-card" onclick="showProductDetail('static-3')">
                    <img src="https://placehold.co/300x300/green/white?text=Recovery" class="product-img">
                    <div style="padding:10px;">
                        <div class="product-name">ë² ë£½ì½” ë¦¬ì»¤ë²„ë¦¬</div>
                        <div class="product-price">18,000ì›</div>
                    </div>
                </div>
                <!-- ìƒ˜í”Œ 4 -->
                <div class="product-card" onclick="showProductDetail('static-4')">
                    <img src="https://placehold.co/300x300/brown/white?text=Trail" class="product-img">
                    <div style="padding:10px;">
                        <div class="product-name">ë² ë£½ì½” íŠ¸ë ˆì¼</div>
                        <div class="product-price">14,000ì›</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- [í™”ë©´ 2] ìƒì„¸ í˜ì´ì§€ -->
        <div id="product-detail-page" class="hidden detail-view">
            <button onclick="goHome()" style="background:none; border:none; cursor:pointer; font-size:1.5rem;">â† ë’¤ë¡œê°€ê¸°</button>
            <div style="text-align: center;">
                <img id="detail-img" class="detail-img" src="" alt="ìƒí’ˆì´ë¯¸ì§€">
                <h2 id="detail-name">ìƒí’ˆëª…</h2>
                <h3 id="detail-price" style="color:var(--primary-color)">0ì›</h3>
            </div>
            <hr style="border:0; border-top:1px solid #eee; margin:20px 0;">
            <div class="form-group">
                <label>ì‚¬ì´ì¦ˆ ì„ íƒ</label>
                <select id="option-size">
                    <option value="S">S (220-240mm)</option>
                    <option value="M">M (245-265mm)</option>
                    <option value="L">L (270-290mm)</option>
                </select>
            </div>
            <div class="form-group">
                <label>ìˆ˜ëŸ‰</label>
                <div style="display: flex; gap: 10px; align-items: center;">
                    <button type="button" onclick="changeQty(-1)" style="padding: 5px 15px;">-</button>
                    <input type="number" id="order-qty" value="1" readonly style="width: 50px; text-align: center;">
                    <button type="button" onclick="changeQty(1)" style="padding: 5px 15px;">+</button>
                </div>
            </div>
            <div class="price-summary">ì´ ê²°ì œ ê¸ˆì•¡ <span id="total-price-display" class="total-price">0ì›</span></div>
            <button class="btn" onclick="addToCart()">ğŸ›’ ì¥ë°”êµ¬ë‹ˆì— ë‹´ê¸°</button>
            <button class="btn btn-secondary" onclick="buyNow()">ë°”ë¡œ êµ¬ë§¤í•˜ê¸°</button>
        </div>

        <!-- [í™”ë©´ 3] ì£¼ë¬¸ì„œ ì‘ì„± -->
        <div id="order-form-page" class="hidden order-view">
            <button onclick="showCart()" style="background:none; border:none; cursor:pointer; font-size:1.5rem;">â† ë’¤ë¡œê°€ê¸°</button>
            <h2>ì£¼ë¬¸ì„œ ì‘ì„±</h2>
            <div class="price-summary">
                <div id="summary-product-name"></div>
                <div id="summary-option-legacy" style="display:none;"><strong>ì˜µì…˜:</strong> <span id="summary-option"></span> / <span id="summary-qty"></span>ê°œ</div>
                <hr>
                <p style="text-align: right;">ê²°ì œ ê¸ˆì•¡: <span id="summary-total" style="font-weight:bold; color:var(--primary-color)"></span></p>
            </div>
            <div class="bank-info">êµ­ë¯¼ì€í–‰ 123-456-789012 (ë² ë£½ì½”)</div>
            <form id="order-form">
                <div class="form-group"><label>ì£¼ë¬¸ì ì´ë¦„</label><input type="text" id="user-name" required placeholder="í™ê¸¸ë™"></div>
                <div class="form-group"><label>ì—°ë½ì²˜</label><input type="tel" id="user-phone" required placeholder="010-1234-5678"></div>
                <div class="form-group"><label>ë°°ì†¡ ì£¼ì†Œ</label><input type="text" id="user-address" required placeholder="ì„œìš¸ì‹œ ..."></div>
                <div class="form-group"><label>ì…ê¸ˆìëª…</label><input type="text" id="deposit-name" required placeholder="í•„ìˆ˜ ì…ë ¥"></div>
                <button type="submit" class="btn" id="btn-order-submit">ì£¼ë¬¸ ì™„ë£Œí•˜ê¸°</button>
            </form>
        </div>

        <!-- [í™”ë©´ 4] ì¥ë°”êµ¬ë‹ˆ -->
        <div id="cart-page" class="hidden detail-view">
            <button onclick="goHome()" style="background:none; border:none; cursor:pointer; font-size:1.5rem;">â† ì‡¼í•‘ ê³„ì†í•˜ê¸°</button>
            <h2>ğŸ›’ ì¥ë°”êµ¬ë‹ˆ</h2>
            
            <div id="cart-items-container">
                <!-- ì¥ë°”êµ¬ë‹ˆ ì•„ì´í…œë“¤ì´ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤ -->
            </div>

            <!-- ë¹ˆ ì¥ë°”êµ¬ë‹ˆ ë©”ì‹œì§€ -->
            <div id="empty-cart" class="empty-cart hidden">
                <div class="empty-cart-icon">ğŸ›’</div>
                <p>ì¥ë°”êµ¬ë‹ˆê°€ ë¹„ì–´ìˆìŠµë‹ˆë‹¤</p>
                <button class="btn" onclick="goHome()">ì‡¼í•‘ ì‹œì‘í•˜ê¸°</button>
            </div>

            <!-- ì¥ë°”êµ¬ë‹ˆ ìš”ì•½ ë° ê²°ì œ ë²„íŠ¼ -->
            <div id="cart-summary-section" class="cart-summary hidden">
                <div class="cart-total">
                    <span>ì´ <span id="cart-total-items">0</span>ê°œ ìƒí’ˆ</span>
                    <span class="cart-total-amount" id="cart-total-price">0ì›</span>
                </div>
                <button class="btn" onclick="proceedToCheckout()">ì£¼ë¬¸í•˜ê¸°</button>
            </div>
        </div>

        <!-- [í™”ë©´ 5] ì£¼ë¬¸ ì™„ë£Œ -->
        <div id="success-page" class="hidden success-view" style="text-align: center; padding: 50px 20px;">
            <div style="font-size: 3rem;">âœ…</div>
            <h2>ì£¼ë¬¸ ì„±ê³µ!</h2>
            <p><strong><span id="final-price"></span>ì›</strong>ì„ ì…ê¸ˆí•´ ì£¼ì„¸ìš”.</p>
            <button class="btn btn-secondary" onclick="goHome()">í™ˆìœ¼ë¡œ</button>
        </div>

        <!-- [í™”ë©´ 5] ê´€ë¦¬ì í˜ì´ì§€ (í™•ì¥ë¨) -->
        <div id="admin-page" class="hidden admin-view">
            <h2>ğŸ‘®â€â™‚ï¸ ê´€ë¦¬ì ëª¨ë“œ</h2>
            
            <!-- ê´€ë¦¬ì íƒ­ ë©”ë‰´ -->
            <div class="admin-nav">
                <button onclick="switchAdminTab('orders')" id="tab-btn-orders" class="active">ì£¼ë¬¸ ê´€ë¦¬</button>
                <button onclick="switchAdminTab('products')" id="tab-btn-products">ìƒí’ˆ ê´€ë¦¬</button>
                <button onclick="switchAdminTab('stats')" id="tab-btn-stats">ë§¤ì¶œ í†µê³„</button>
            </div>

            <!-- íƒ­ 1: ì£¼ë¬¸ ëª©ë¡ -->
            <div id="admin-tab-orders">
                <h3>ì‹¤ì‹œê°„ ì£¼ë¬¸ í˜„í™©</h3>
                <div id="admin-order-list">ë¡œë”© ì¤‘...</div>
            </div>

            <!-- íƒ­ 2: ìƒí’ˆ ê´€ë¦¬ (ì¶”ê°€/ìˆ˜ì •/ì‚­ì œ) -->
            <div id="admin-tab-products" class="hidden">
                <h3>ìƒí’ˆ ë“±ë¡ ë° ê´€ë¦¬</h3>
                
                <!-- ìƒí’ˆ ë“±ë¡/ìˆ˜ì • í¼ -->
                <div style="background:#f9f9f9; padding:20px; border-radius:8px; margin-bottom:20px; border:1px solid #ddd;">
                    <h4 style="margin-top:0;" id="product-form-title">ìƒˆ ìƒí’ˆ ë“±ë¡</h4>
                    <form id="add-product-form">
                        <input type="hidden" id="edit-prod-id"> <!-- ìˆ˜ì • ëª¨ë“œì¼ ë•Œ ID ì €ì¥ -->
                        
                        <!-- ê¸°ë³¸ ì •ë³´ ì„¹ì…˜ -->
                        <div style="background: white; padding: 15px; border-radius: 5px; margin-bottom: 15px;">
                            <h5 style="margin-top: 0; color: var(--admin-bg);">ğŸ“ ê¸°ë³¸ ì •ë³´</h5>
                            
                            <div class="form-group">
                                <label>ìƒí’ˆëª… *</label>
                                <input type="text" id="new-prod-name" placeholder="ì˜ˆ: ë² ë£½ì½” ìš¸íŠ¸ë¼ ì‚­ìŠ¤" required>
                            </div>
                            
                            <div class="form-group">
                                <label>ìƒí’ˆ ì¹´í…Œê³ ë¦¬</label>
                                <select id="new-prod-category">
                                    <option value="running">ëŸ¬ë‹ìš©</option>
                                    <option value="trail">íŠ¸ë ˆì¼ìš©</option>
                                    <option value="recovery">ë¦¬ì»¤ë²„ë¦¬ìš©</option>
                                    <option value="daily">ì¼ìƒìš©</option>
                                </select>
                            </div>
                            
                            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px;">
                                <div class="form-group">
                                    <label>ì •ê°€ (ì›) *</label>
                                    <input type="number" id="new-prod-price" placeholder="15000" required>
                                </div>
                                
                                <div class="form-group">
                                    <label>í• ì¸ê°€ (ì›)</label>
                                    <input type="number" id="new-prod-sale-price" placeholder="í• ì¸ ì‹œì—ë§Œ ì…ë ¥">
                                </div>
                            </div>
                            
                            <div class="form-group">
                                <label>ì¬ê³  ìˆ˜ëŸ‰</label>
                                <input type="number" id="new-prod-stock" placeholder="999" value="999">
                                <small style="color:#888;">* ì¬ê³ ê°€ 0ì´ë©´ 'í’ˆì ˆ' í‘œì‹œë©ë‹ˆë‹¤</small>
                            </div>
                        </div>
                        
                        <!-- ì´ë¯¸ì§€ ì •ë³´ ì„¹ì…˜ -->
                        <div style="background: white; padding: 15px; border-radius: 5px; margin-bottom: 15px;">
                            <h5 style="margin-top: 0; color: var(--admin-bg);">ğŸ–¼ï¸ ì´ë¯¸ì§€ ì •ë³´</h5>
                            
                            <div class="form-group">
                                <label>ë©”ì¸ ì´ë¯¸ì§€ URL *</label>
                                <input type="text" id="new-prod-img" placeholder="https://placehold.co/300x300/orange/white?text=Product" required>
                                <small style="color:#888;">
                                    * ë¬´ë£Œ ì´ë¯¸ì§€: <a href="https://placehold.co" target="_blank">placehold.co</a>, 
                                    <a href="https://unsplash.com" target="_blank">unsplash.com</a>
                                </small>
                            </div>
                            
                            <div class="form-group">
                                <label>ìƒì„¸ ì´ë¯¸ì§€ URL (ì„ íƒ)</label>
                                <textarea id="new-prod-detail-imgs" rows="3" placeholder="ì´ë¯¸ì§€ URLì„ ì¤„ë°”ê¿ˆìœ¼ë¡œ êµ¬ë¶„í•˜ì—¬ ì…ë ¥
https://example.com/detail1.jpg
https://example.com/detail2.jpg"></textarea>
                                <small style="color:#888;">* ìƒì„¸ í˜ì´ì§€ì— ì¶”ê°€ë¡œ í‘œì‹œë  ì´ë¯¸ì§€ë“¤</small>
                            </div>
                        </div>
                        
                        <!-- ìƒì„¸ ì„¤ëª… ì„¹ì…˜ -->
                        <div style="background: white; padding: 15px; border-radius: 5px; margin-bottom: 15px;">
                            <h5 style="margin-top: 0; color: var(--admin-bg);">ğŸ“‹ ìƒì„¸ ì„¤ëª…</h5>
                            
                            <div class="form-group">
                                <label>í•œì¤„ ì†Œê°œ</label>
                                <input type="text" id="new-prod-summary" placeholder="ì˜ˆ: ì´ˆê²½ëŸ‰ ë©”ì‹œ ì†Œì¬ë¡œ í†µê¸°ì„±ì´ ë›°ì–´ë‚œ ëŸ¬ë‹ ì–‘ë§">
                            </div>
                            
                            <div class="form-group">
                                <label>ìƒì„¸ ì„¤ëª…</label>
                                <textarea id="new-prod-description" rows="5" placeholder="ìƒí’ˆì˜ íŠ¹ì§•, ì†Œì¬, ì‚¬ìš© ìš©ë„ ë“±ì„ ìì„¸íˆ ì…ë ¥í•˜ì„¸ìš”.

ì˜ˆ:
- ì†Œì¬: í´ë¦¬ì—ìŠ¤í„° 70%, ë‚˜ì¼ë¡  25%, ìŠ¤íŒë±ìŠ¤ 5%
- íŠ¹ì§•: ë©”ì‹œ êµ¬ì¡°ë¡œ í†µê¸°ì„± ìš°ìˆ˜, ì•„ì¹˜ ì„œí¬íŠ¸, ë°œëª© ì¿ ì…˜
- ì¶”ì²œ: 5km ì´ìƒ ì¥ê±°ë¦¬ ëŸ¬ë‹, ë§ˆë¼í†¤ í›ˆë ¨"></textarea>
                            </div>
                        </div>
                        
                        <!-- ì¶”ê°€ ì˜µì…˜ ì„¹ì…˜ -->
                        <div style="background: white; padding: 15px; border-radius: 5px; margin-bottom: 15px;">
                            <h5 style="margin-top: 0; color: var(--admin-bg);">âš™ï¸ ì¶”ê°€ ì˜µì…˜</h5>
                            
                            <div class="form-group">
                                <label>
                                    <input type="checkbox" id="new-prod-bestseller"> 
                                    ë² ìŠ¤íŠ¸ì…€ëŸ¬ í‘œì‹œ
                                </label>
                            </div>
                            
                            <div class="form-group">
                                <label>
                                    <input type="checkbox" id="new-prod-new"> 
                                    ì‹ ìƒí’ˆ í‘œì‹œ
                                </label>
                            </div>
                            
                            <div class="form-group">
                                <label>ì œí’ˆ íƒœê·¸ (ì‰¼í‘œë¡œ êµ¬ë¶„)</label>
                                <input type="text" id="new-prod-tags" placeholder="ì˜ˆ: ê²½ëŸ‰, ë©”ì‹œ, í†µê¸°ì„±, ì—¬ë¦„ìš©">
                                <small style="color:#888;">* ê²€ìƒ‰ ë° í•„í„°ë§ì— ì‚¬ìš©ë©ë‹ˆë‹¤</small>
                            </div>
                        </div>
                        
                        <div style="display:flex; gap:10px;">
                            <button type="submit" class="btn btn-small" id="btn-save-product" style="flex: 1;">âœ… ìƒí’ˆ ì¶”ê°€í•˜ê¸°</button>
                            <button type="button" class="btn btn-small btn-secondary hidden" id="btn-cancel-edit" onclick="cancelEdit()" style="flex: 1;">ì·¨ì†Œ</button>
                        </div>
                    </form>
                </div>

                <!-- ìƒí’ˆ ëª©ë¡ (ì‚­ì œ/ìˆ˜ì •ìš©) -->
                <h4>ë“±ë¡ëœ ìƒí’ˆ ëª©ë¡</h4>
                <div id="admin-product-list">
                    <!-- JSë¡œ ì±„ì›Œì§ -->
                </div>
            </div>

            <!-- íƒ­ 3: ë§¤ì¶œ í†µê³„ (ì£¼ë¬¸ ìš”ì•½) -->
            <div id="admin-tab-stats" class="hidden">
                <h3>ğŸ“Š ì „ì²´ ë§¤ì¶œ í˜„í™©</h3>
                <div class="stats-container">
                    <div class="stat-card">
                        <div class="stat-label">ì´ ë§¤ì¶œì•¡</div>
                        <div class="stat-value" id="stat-total-revenue">0ì›</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-label">ì´ ì£¼ë¬¸ ê±´ìˆ˜</div>
                        <div class="stat-value" id="stat-total-count">0ê±´</div>
                    </div>
                </div>

                <!-- ì¶”ê°€ í†µê³„: ë°°ì†¡ í˜„í™© -->
                <h4>ë°°ì†¡ ì²˜ë¦¬ í˜„í™©</h4>
                <div class="stats-container" style="margin-bottom:20px;">
                    <div class="stat-card" style="background-color:#fff3e0;">
                        <div class="stat-label">ë°°ì†¡ ëŒ€ê¸°</div>
                        <div class="stat-value" id="stat-pending-count" style="color:#e65100">0ê±´</div>
                    </div>
                    <div class="stat-card" style="background-color:#e8f5e9;">
                        <div class="stat-label">ë°°ì†¡ ì™„ë£Œ</div>
                        <div class="stat-value" id="stat-completed-count" style="color:#2e7d32">0ê±´</div>
                    </div>
                </div>
                
                <h4>ìƒí’ˆë³„ íŒë§¤ëŸ‰</h4>
                <ul id="stat-product-breakdown" style="list-style: none; padding: 0;">
                    <!-- JSë¡œ ì±„ì›Œì§ -->
                </ul>
            </div>

            <button class="btn btn-secondary" onclick="goHome()" style="margin-top:20px;">ì‡¼í•‘ëª°ë¡œ ëŒì•„ê°€ê¸°</button>
        </div>

    </div>

    <footer>
        <div class="footer-content">
            <button class="admin-btn" onclick="goToAdmin()">ğŸ” ê´€ë¦¬ì ëª¨ë“œ</button>
            <div class="copyright">Â© 2024 Verunco Socks Corp.</div>
        </div>
    </footer>

    <!-- Firebase SDK ë° ì „ì—­ ë³€ìˆ˜ ì„ ì–¸ -->
    <script>
        // [ìˆ˜ì •1] ì „ì—­ ë³€ìˆ˜ë“¤ì„ ìŠ¤í¬ë¦½íŠ¸ ìµœìƒë‹¨ì— ì„ ì–¸
        const defaultProducts = [
            { id: 'static-1', name: "ë² ë£½ì½” ìŠ¤í”¼ë“œ (ì´ˆê²½ëŸ‰)", price: 12000, img: "https://placehold.co/300x300/orange/white?text=Speed" },
            { id: 'static-2', name: "ë² ë£½ì½” ë§ˆë¼í†¤ í”„ë¡œ", price: 15000, img: "https://placehold.co/300x300/navy/white?text=Marathon" },
            { id: 'static-3', name: "ë² ë£½ì½” ë¦¬ì»¤ë²„ë¦¬", price: 18000, img: "https://placehold.co/300x300/green/white?text=Recovery" },
            { id: 'static-4', name: "ë² ë£½ì½” íŠ¸ë ˆì¼", price: 14000, img: "https://placehold.co/300x300/brown/white?text=Trail" }
        ];

        let products = [...defaultProducts]; // ì´ˆê¸°ê°’ ì„¤ì •
        let selectedProduct = null;
        let currentQty = 1;
        let allOrders = [];
        let cart = []; // ì¥ë°”êµ¬ë‹ˆ ë°°ì—´

        // [ìˆ˜ì •2] í•µì‹¬ UI í•¨ìˆ˜ë“¤ì„ ì¦‰ì‹œ ì „ì—­ìœ¼ë¡œ ì •ì˜
        function switchView(viewId) {
            ['main-page', 'product-detail-page', 'cart-page', 'order-form-page', 'success-page', 'admin-page'].forEach(id => {
                document.getElementById(id).classList.add('hidden');
            });
            document.getElementById(viewId).classList.remove('hidden');
            window.scrollTo(0, 0);
        }

        function goHome() { 
            selectedProduct = null; 
            switchView('main-page'); 
        }
        
        function showProductDetail(id) {
            console.log('showProductDetail í˜¸ì¶œ:', id, 'products:', products);
            selectedProduct = products.find(p => p.id === id);
            if(!selectedProduct) {
                console.error('ìƒí’ˆì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤:', id);
                return;
            }
            currentQty = 1;
            document.getElementById('detail-img').src = selectedProduct.img;
            document.getElementById('detail-name').innerText = selectedProduct.name;
            document.getElementById('detail-price').innerText = Number(selectedProduct.price).toLocaleString() + "ì›";
            document.getElementById('order-qty').value = currentQty;
            updateTotalPrice();
            switchView('product-detail-page');
        }

        function changeQty(change) {
            currentQty += change;
            if (currentQty < 1) currentQty = 1;
            document.getElementById('order-qty').value = currentQty;
            updateTotalPrice();
        }

        function updateTotalPrice() {
            const total = selectedProduct.price * currentQty;
            document.getElementById('total-price-display').innerText = total.toLocaleString() + "ì›";
        }

        function goToOrderForm() {
            const size = document.getElementById('option-size').value;
            const total = selectedProduct.price * currentQty;
            document.getElementById('summary-product-name').innerText = selectedProduct.name;
            document.getElementById('summary-option').innerText = size;
            document.getElementById('summary-qty').innerText = currentQty;
            document.getElementById('summary-total').innerText = total.toLocaleString() + "ì›";
            switchView('order-form-page');
        }

        function goBackToDetail() { 
            switchView('product-detail-page'); 
        }
        
        function goToAdmin() { 
            if(confirm("ê´€ë¦¬ì ëª¨ë“œë¡œ ì§„ì…í•˜ì‹œê² ìŠµë‹ˆê¹Œ?")) {
                switchView('admin-page');
            }
        }

        // ===== ì¥ë°”êµ¬ë‹ˆ ê¸°ëŠ¥ =====
        
        // ì¥ë°”êµ¬ë‹ˆ ì—…ë°ì´íŠ¸ (ë°°ì§€ ë° UI)
        function updateCartUI() {
            const badge = document.getElementById('cart-badge');
            const totalItems = cart.reduce((sum, item) => sum + item.qty, 0);
            
            if (totalItems > 0) {
                badge.textContent = totalItems;
                badge.classList.remove('hidden');
            } else {
                badge.classList.add('hidden');
            }
            
            // localStorageì— ì €ì¥
            localStorage.setItem('berunko_cart', JSON.stringify(cart));
        }

        // ì¥ë°”êµ¬ë‹ˆì— ìƒí’ˆ ì¶”ê°€
        function addToCart() {
            if (!selectedProduct) return;
            
            const size = document.getElementById('option-size').value;
            const qty = currentQty;
            
            // ê°™ì€ ìƒí’ˆ, ê°™ì€ ì˜µì…˜ì´ ìˆëŠ”ì§€ í™•ì¸
            const existingIndex = cart.findIndex(item => 
                item.id === selectedProduct.id && item.option === size
            );
            
            if (existingIndex >= 0) {
                // ì´ë¯¸ ìˆìœ¼ë©´ ìˆ˜ëŸ‰ë§Œ ì¦ê°€
                cart[existingIndex].qty += qty;
                alert('ì¥ë°”êµ¬ë‹ˆì— ìˆ˜ëŸ‰ì´ ì¶”ê°€ë˜ì—ˆìŠµë‹ˆë‹¤!');
            } else {
                // ìƒˆ ì•„ì´í…œ ì¶”ê°€
                cart.push({
                    id: selectedProduct.id,
                    name: selectedProduct.name,
                    price: selectedProduct.price,
                    img: selectedProduct.img,
                    option: size,
                    qty: qty
                });
                alert('ì¥ë°”êµ¬ë‹ˆì— ë‹´ê²¼ìŠµë‹ˆë‹¤!');
            }
            
            updateCartUI();
        }

        // ë°”ë¡œ êµ¬ë§¤ (ì¥ë°”êµ¬ë‹ˆ ê±°ì¹˜ì§€ ì•Šê³  ë°”ë¡œ ì£¼ë¬¸)
        function buyNow() {
            const size = document.getElementById('option-size').value;
            const qty = currentQty;
            
            // ì„ì‹œ ì¥ë°”êµ¬ë‹ˆë¡œ ì„¤ì •
            cart = [{
                id: selectedProduct.id,
                name: selectedProduct.name,
                price: selectedProduct.price,
                img: selectedProduct.img,
                option: size,
                qty: qty
            }];
            
            proceedToCheckout();
        }

        // ì¥ë°”êµ¬ë‹ˆ í™”ë©´ ë³´ê¸°
        function showCart() {
            const container = document.getElementById('cart-items-container');
            const emptyCart = document.getElementById('empty-cart');
            const summarySection = document.getElementById('cart-summary-section');
            
            if (cart.length === 0) {
                container.innerHTML = '';
                emptyCart.classList.remove('hidden');
                summarySection.classList.add('hidden');
            } else {
                emptyCart.classList.add('hidden');
                summarySection.classList.remove('hidden');
                
                // ì¥ë°”êµ¬ë‹ˆ ì•„ì´í…œ ë Œë”ë§
                container.innerHTML = cart.map((item, index) => `
                    <div class="cart-item">
                        <img src="${item.img}" class="cart-item-img" onerror="this.src='https://placehold.co/80?text=No+Image'">
                        <div class="cart-item-info">
                            <div class="cart-item-name">${item.name}</div>
                            <div class="cart-item-option">ì‚¬ì´ì¦ˆ: ${item.option}</div>
                            <div class="cart-item-price">${(item.price * item.qty).toLocaleString()}ì›</div>
                        </div>
                        <div class="cart-qty-control">
                            <button class="cart-qty-btn" onclick="updateCartQty(${index}, -1)">-</button>
                            <span style="min-width: 30px; text-align: center;">${item.qty}</span>
                            <button class="cart-qty-btn" onclick="updateCartQty(${index}, 1)">+</button>
                        </div>
                        <button class="cart-remove-btn" onclick="removeFromCart(${index})" title="ì‚­ì œ">ğŸ—‘ï¸</button>
                    </div>
                `).join('');
                
                // ì´ ê¸ˆì•¡ ê³„ì‚°
                const totalItems = cart.reduce((sum, item) => sum + item.qty, 0);
                const totalPrice = cart.reduce((sum, item) => sum + (item.price * item.qty), 0);
                
                document.getElementById('cart-total-items').textContent = totalItems;
                document.getElementById('cart-total-price').textContent = totalPrice.toLocaleString() + 'ì›';
            }
            
            switchView('cart-page');
        }

        // ì¥ë°”êµ¬ë‹ˆ ìˆ˜ëŸ‰ ë³€ê²½
        function updateCartQty(index, change) {
            cart[index].qty += change;
            
            if (cart[index].qty <= 0) {
                if (confirm('ì´ ìƒí’ˆì„ ì¥ë°”êµ¬ë‹ˆì—ì„œ ì œê±°í•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {
                    cart.splice(index, 1);
                } else {
                    cart[index].qty = 1;
                }
            }
            
            updateCartUI();
            showCart(); // í™”ë©´ ê°±ì‹ 
        }

        // ì¥ë°”êµ¬ë‹ˆì—ì„œ ìƒí’ˆ ì œê±°
        function removeFromCart(index) {
            if (confirm('ì´ ìƒí’ˆì„ ì¥ë°”êµ¬ë‹ˆì—ì„œ ì œê±°í•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {
                cart.splice(index, 1);
                updateCartUI();
                showCart(); // í™”ë©´ ê°±ì‹ 
            }
        }

        // ì£¼ë¬¸ì„œë¡œ ì´ë™
        function proceedToCheckout() {
            if (cart.length === 0) {
                alert('ì¥ë°”êµ¬ë‹ˆê°€ ë¹„ì–´ìˆìŠµë‹ˆë‹¤.');
                return;
            }
            
            // ì£¼ë¬¸ ìš”ì•½ ì •ë³´ í‘œì‹œ
            const summaryHtml = cart.map(item => 
                `<p><strong>${item.name}</strong> (${item.option}) x ${item.qty}ê°œ = ${(item.price * item.qty).toLocaleString()}ì›</p>`
            ).join('');
            
            const totalPrice = cart.reduce((sum, item) => sum + (item.price * item.qty), 0);
            
            document.getElementById('summary-product-name').innerHTML = summaryHtml;
            document.getElementById('summary-option').innerHTML = ''; // ê°œë³„ ì˜µì…˜ ìˆ¨ê¹€
            document.getElementById('summary-qty').innerHTML = ''; // ê°œë³„ ìˆ˜ëŸ‰ ìˆ¨ê¹€
            document.getElementById('summary-total').textContent = totalPrice.toLocaleString() + 'ì›';
            
            switchView('order-form-page');
        }

        // í˜ì´ì§€ ë¡œë“œ ì‹œ localStorageì—ì„œ ì¥ë°”êµ¬ë‹ˆ ë³µì›
        function loadCartFromStorage() {
            const saved = localStorage.getItem('berunko_cart');
            if (saved) {
                try {
                    cart = JSON.parse(saved);
                    updateCartUI();
                } catch (e) {
                    console.error('ì¥ë°”êµ¬ë‹ˆ ë¡œë“œ ì‹¤íŒ¨:', e);
                    cart = [];
                }
            }
        }

        // í˜ì´ì§€ ë¡œë“œ ì‹œ ì¥ë°”êµ¬ë‹ˆ ë³µì›
        loadCartFromStorage();

        // ===== ê¸°ì¡´ í•¨ìˆ˜ë“¤ =====

        function switchAdminTab(tabName) {
            ['orders', 'products', 'stats'].forEach(t => {
                document.getElementById(`tab-btn-${t}`).classList.remove('active');
                document.getElementById(`admin-tab-${t}`).classList.add('hidden');
            });
            document.getElementById(`tab-btn-${tabName}`).classList.add('active');
            document.getElementById(`admin-tab-${tabName}`).classList.remove('hidden');
        }

        function editProduct(id) {
            const p = products.find(prod => prod.id === id);
            if (!p) return;

            document.getElementById('product-form-title').innerText = "ìƒí’ˆ ìˆ˜ì • ëª¨ë“œ";
            document.getElementById('edit-prod-id').value = id;
            
            // ê¸°ë³¸ ì •ë³´
            document.getElementById('new-prod-name').value = p.name || '';
            document.getElementById('new-prod-price').value = p.price || '';
            document.getElementById('new-prod-sale-price').value = p.salePrice || '';
            document.getElementById('new-prod-category').value = p.category || 'running';
            document.getElementById('new-prod-stock').value = p.stock || 999;
            
            // ì´ë¯¸ì§€ ì •ë³´
            document.getElementById('new-prod-img').value = p.img || '';
            document.getElementById('new-prod-detail-imgs').value = p.detailImgs ? p.detailImgs.join('\n') : '';
            
            // ìƒì„¸ ì„¤ëª…
            document.getElementById('new-prod-summary').value = p.summary || '';
            document.getElementById('new-prod-description').value = p.description || '';
            
            // ì¶”ê°€ ì˜µì…˜
            document.getElementById('new-prod-bestseller').checked = p.isBestseller || false;
            document.getElementById('new-prod-new').checked = p.isNew || false;
            document.getElementById('new-prod-tags').value = p.tags ? p.tags.join(', ') : '';
            
            document.getElementById('btn-save-product').innerText = "ğŸ’¾ ìˆ˜ì •ì‚¬í•­ ì €ì¥";
            document.getElementById('btn-cancel-edit').classList.remove('hidden');
            
            document.getElementById('add-product-form').scrollIntoView({ behavior: 'smooth' });
        }

        function cancelEdit() {
            document.getElementById('product-form-title').innerText = "ìƒˆ ìƒí’ˆ ë“±ë¡";
            document.getElementById('edit-prod-id').value = "";
            document.getElementById('add-product-form').reset();
            
            document.getElementById('btn-save-product').innerText = "âœ… ìƒí’ˆ ì¶”ê°€í•˜ê¸°";
            document.getElementById('btn-cancel-edit').classList.add('hidden');
        }
    </script>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js";
        import { getAuth, signInAnonymously, signInWithCustomToken, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js";
        import { getFirestore, collection, addDoc, onSnapshot, updateDoc, doc, deleteDoc, serverTimestamp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js";

        // 1. Firebase ì´ˆê¸°í™”
        // [ì‹¤ì œ ë°°í¬ì‹œ] ì•„ë˜ ì„¤ì •ê°’ì„ ì‚¬ìš©í•©ë‹ˆë‹¤
        const firebaseConfig = {
            apiKey: "AIzaSyDHC0F79_7jnC-YwV48Tiusg0NMHdtPhj4",
            authDomain: "berunko-5c8bf.firebaseapp.com",
            projectId: "berunko-5c8bf",
            storageBucket: "berunko-5c8bf.firebasestorage.app",
            messagingSenderId: "933523639470",
            appId: "1:933523639470:web:33967d8bc13e284a80f13f"
        };
        
        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);
        const db = getFirestore(app);

        let currentUser = null;

        // 2. ì¸ì¦ ë° ë¦¬ìŠ¤ë„ˆ ì‹œì‘
        async function initAuth() {
            try { 
                await signInAnonymously(auth); 
                console.log("Firebase ìµëª… ì¸ì¦ ì„±ê³µ");
            } 
            catch (e) { 
                console.error("ì¸ì¦ ì‹¤íŒ¨:", e); 
            }
        }
        
        onAuthStateChanged(auth, (user) => {
            if (user) {
                currentUser = user;
                setupProductListener(); 
                setupOrderListener();
            }
        });
        initAuth();

        // [ê¸°ëŠ¥ 1] ìƒí’ˆ ë°ì´í„° ì‹¤ì‹œê°„ ë™ê¸°í™” (CRUD: Read)
        function setupProductListener() {
            const listContainer = document.getElementById('product-list');
            const adminListContainer = document.getElementById('admin-product-list');

            try {
                const productCollection = collection(db, 'products');
                
                onSnapshot(productCollection, (snapshot) => {
                    if (snapshot.empty) {
                        if (products.length === 4 && products[0].id === 'static-1') {
                            console.log("DB ë¹„ì–´ìˆìŒ. ì‹œë”© ì‹œì‘...");
                            seedInitialProducts();
                        }
                        return; 
                    }

                    let tempProducts = [];
                    snapshot.forEach(docSnap => {
                        tempProducts.push({ id: docSnap.id, ...docSnap.data() });
                    });
                    
                    tempProducts.sort((a, b) => {
                        const timeA = a.createdAt ? a.createdAt.seconds : 0;
                        const timeB = b.createdAt ? b.createdAt.seconds : 0;
                        return timeB - timeA;
                    });
                    
                    products = tempProducts;

                    listContainer.innerHTML = "";
                    adminListContainer.innerHTML = "";

                    products.forEach(p => {
                        // 1. ë©”ì¸ í™”ë©´ ì¹´ë“œ
                        const card = document.createElement('div');
                        card.className = 'product-card';
                        card.onclick = () => showProductDetail(p.id);
                        card.innerHTML = `
                            <img src="${p.img}" class="product-img" onerror="this.src='https://placehold.co/300?text=No+Image'">
                            <div style="padding:10px;">
                                <div class="product-name">${p.name}</div>
                                <div class="product-price">${Number(p.price).toLocaleString()}ì›</div>
                            </div>
                        `;
                        listContainer.appendChild(card);

                        // 2. ê´€ë¦¬ì í™”ë©´ ë¦¬ìŠ¤íŠ¸
                        const adminItem = document.createElement('div');
                        adminItem.className = 'admin-product-item';
                        adminItem.innerHTML = `
                            <div class="admin-product-info">
                                <img src="${p.img}" class="admin-product-thumb">
                                <div>
                                    <strong>${p.name}</strong><br>
                                    ${Number(p.price).toLocaleString()}ì›
                                </div>
                            </div>
                            <div>
                                <button class="btn btn-small btn-edit" onclick="editProduct('${p.id}')">ìˆ˜ì •</button>
                                <button class="btn btn-small btn-danger" onclick="deleteProduct('${p.id}')">ì‚­ì œ</button>
                            </div>
                        `;
                        adminListContainer.appendChild(adminItem);
                    });
                }, (error) => {
                    console.error("ë°ì´í„° ì½ê¸° ê¶Œí•œ/ë„¤íŠ¸ì›Œí¬ ì˜¤ë¥˜:", error);
                });
            } catch (err) {
                console.error("ë¦¬ìŠ¤ë„ˆ ì„¤ì • ì¤‘ ì˜¤ë¥˜:", err);
            }
        }

        async function seedInitialProducts() {
            const initialData = [
                { 
                    name: "ë² ë£½ì½” ìŠ¤í”¼ë“œ (ì´ˆê²½ëŸ‰)", 
                    price: 12000, 
                    salePrice: null,
                    category: "running",
                    stock: 999,
                    img: "https://placehold.co/300x300/orange/white?text=Speed",
                    detailImgs: [],
                    summary: "ì´ˆê²½ëŸ‰ ë©”ì‹œ ì†Œì¬ë¡œ í†µê¸°ì„±ì´ ë›°ì–´ë‚œ ëŸ¬ë‹ ì „ìš© ì–‘ë§",
                    description: "- ì†Œì¬: í´ë¦¬ì—ìŠ¤í„° 65%, ë‚˜ì¼ë¡  30%, ìŠ¤íŒë±ìŠ¤ 5%\n- ë¬´ê²Œ: 25g (1ì¼¤ë ˆ ê¸°ì¤€)\n- íŠ¹ì§•: ì´ˆê²½ëŸ‰, ë©”ì‹œ í†µê¸°ì„±, ì•„ì¹˜ ì„œí¬íŠ¸\n- ì¶”ì²œ: 5km~10km ì†ë„ í›ˆë ¨, ë ˆì´ìŠ¤",
                    isBestseller: true,
                    isNew: false,
                    tags: ["ê²½ëŸ‰", "ë©”ì‹œ", "í†µê¸°ì„±", "ì†ë„í›ˆë ¨"]
                },
                { 
                    name: "ë² ë£½ì½” ë§ˆë¼í†¤ í”„ë¡œ", 
                    price: 15000,
                    salePrice: null,
                    category: "running",
                    stock: 999,
                    img: "https://placehold.co/300x300/navy/white?text=Marathon",
                    detailImgs: [],
                    summary: "ì¥ê±°ë¦¬ ë§ˆë¼í†¤ì„ ìœ„í•œ í”„ë¡œê¸‰ ì¿ ì…”ë‹ ì–‘ë§",
                    description: "- ì†Œì¬: ë©”ë¦¬ë…¸ìš¸ 40%, ë‚˜ì¼ë¡  55%, ìŠ¤íŒë±ìŠ¤ 5%\n- íŠ¹ì§•: ë°œë°”ë‹¥ ì¿ ì…”ë‹, ë°œëª© ë³´í˜¸, ìŠµê¸° ì¡°ì ˆ\n- ì¶”ì²œ: í•˜í”„/í’€ ë§ˆë¼í†¤, ì¥ê±°ë¦¬ ëŸ¬ë‹",
                    isBestseller: true,
                    isNew: false,
                    tags: ["ë§ˆë¼í†¤", "ì¿ ì…”ë‹", "ì¥ê±°ë¦¬", "ë©”ë¦¬ë…¸ìš¸"]
                },
                { 
                    name: "ë² ë£½ì½” ë¦¬ì»¤ë²„ë¦¬", 
                    price: 18000,
                    salePrice: 14900,
                    category: "recovery",
                    stock: 999,
                    img: "https://placehold.co/300x300/green/white?text=Recovery",
                    detailImgs: [],
                    summary: "ìš´ë™ í›„ íšŒë³µì„ ë•ëŠ” ì»´í”„ë ˆì…˜ ì–‘ë§",
                    description: "- ì†Œì¬: ë‚˜ì¼ë¡  70%, ìŠ¤íŒë±ìŠ¤ 30%\n- ì••ë°•ë ¥: 15-20mmHg\n- íŠ¹ì§•: í˜ˆì•¡ìˆœí™˜ ì´‰ì§„, í”¼ë¡œ íšŒë³µ, ë¶€ì¢… ì™„í™”\n- ì¶”ì²œ: ìš´ë™ í›„ ì°©ìš©, ì¥ì‹œê°„ ì´ë™",
                    isBestseller: false,
                    isNew: true,
                    tags: ["íšŒë³µ", "ì»´í”„ë ˆì…˜", "ì••ë°•", "í˜ˆì•¡ìˆœí™˜"]
                },
                { 
                    name: "ë² ë£½ì½” íŠ¸ë ˆì¼", 
                    price: 14000,
                    salePrice: null,
                    category: "trail",
                    stock: 999,
                    img: "https://placehold.co/300x300/brown/white?text=Trail",
                    detailImgs: [],
                    summary: "í—˜ë‚œí•œ íŠ¸ë ˆì¼ì„ ìœ„í•œ ë‚´êµ¬ì„± ê°•í™” ì–‘ë§",
                    description: "- ì†Œì¬: ìš¸ 30%, ë‚˜ì¼ë¡  65%, ìŠ¤íŒë±ìŠ¤ 5%\n- íŠ¹ì§•: ê°•í™”ëœ ë°œë/ë’¤ê¿ˆì¹˜, ë°©ìˆ˜ ì²˜ë¦¬, ë¯¸ë„ëŸ¼ ë°©ì§€\n- ì¶”ì²œ: íŠ¸ë ˆì¼ ëŸ¬ë‹, ë“±ì‚°, ì•„ì›ƒë„ì–´",
                    isBestseller: false,
                    isNew: false,
                    tags: ["íŠ¸ë ˆì¼", "ë“±ì‚°", "ë‚´êµ¬ì„±", "ë°©ìˆ˜"]
                }
            ];
            const promises = initialData.map(p => 
                addDoc(collection(db, 'products'), {
                    ...p, createdAt: serverTimestamp()
                })
            );
            await Promise.all(promises);
            console.log("ì´ˆê¸° ìƒí’ˆ ë°ì´í„° ìƒì„± ì™„ë£Œ");
        }

        // [ê¸°ëŠ¥ 2] ì£¼ë¬¸ ë°ì´í„° ë¦¬ìŠ¤ë„ˆ & í†µê³„ ì§‘ê³„
        function setupOrderListener() {
            const orderCollection = collection(db, 'orders');

            onSnapshot(orderCollection, (snapshot) => {
                const listContainer = document.getElementById('admin-order-list');
                
                allOrders = [];
                let html = "";

                if (snapshot.empty) {
                    listContainer.innerHTML = "<div class='status-msg'>ì£¼ë¬¸ ë‚´ì—­ì´ ì—†ìŠµë‹ˆë‹¤.</div>";
                    return;
                }

                snapshot.forEach((docSnap) => {
                    allOrders.push({ id: docSnap.id, ...docSnap.data() });
                });

                allOrders.sort((a, b) => {
                    const timeA = a.orderDate ? a.orderDate.seconds : 0;
                    const timeB = b.orderDate ? b.orderDate.seconds : 0;
                    return timeB - timeA;
                });

                allOrders.forEach((data) => {
                    const date = data.orderDate ? new Date(data.orderDate.seconds * 1000).toLocaleString() : "ë°©ê¸ˆ ì „";
                    const statusClass = data.status === 'ë°°ì†¡ì™„ë£Œ' ? 'status-completed' : 'status-pending';
                    
                    html += `
                        <div class="order-item">
                            <div class="order-header">
                                <span>${date}</span>
                                <span class="status-badge ${statusClass}">${data.status}</span>
                            </div>
                            <div><strong>[${data.productName}]</strong> ${data.qty}ê°œ (${Number(data.totalPrice).toLocaleString()}ì›)</div>
                            <div style="font-size:0.8rem; color:#666; margin-top:5px;">
                                ${data.userName} / ${data.userAddress}
                            </div>
                            ${data.status !== 'ë°°ì†¡ì™„ë£Œ' ? 
                                `<button class="btn btn-small" style="margin-top:5px;" onclick="updateOrderStatus('${data.id}')">ë°°ì†¡ì²˜ë¦¬</button>` : ''}
                        </div>
                    `;
                });
                listContainer.innerHTML = html;
                calculateStats();
            }, (error) => {
                console.error("ì£¼ë¬¸ ë°ì´í„° ë¡œë”© ì‹¤íŒ¨:", error);
                document.getElementById('admin-order-list').innerHTML = `<div class="status-msg error-msg">ì£¼ë¬¸ ëª©ë¡ ë¡œë”© ì‹¤íŒ¨<br>${error.message}</div>`;
            });
        }

        // [ê¸°ëŠ¥ 3] í†µê³„ ê³„ì‚° (ì£¼ë¬¸ ìš”ì•½)
        function calculateStats() {
            let totalRevenue = 0;
            let productCounts = {};
            let pendingCount = 0;
            let completedCount = 0;

            allOrders.forEach(order => {
                totalRevenue += (order.totalPrice || 0);
                
                if (order.status === 'ë°°ì†¡ì™„ë£Œ') completedCount++;
                else pendingCount++;

                const pName = order.productName || "ì•Œìˆ˜ì—†ìŒ";
                if (!productCounts[pName]) productCounts[pName] = 0;
                productCounts[pName] += (order.qty || 0);
            });

            document.getElementById('stat-total-revenue').innerText = totalRevenue.toLocaleString() + "ì›";
            document.getElementById('stat-total-count').innerText = allOrders.length + "ê±´";
            document.getElementById('stat-pending-count').innerText = pendingCount + "ê±´";
            document.getElementById('stat-completed-count').innerText = completedCount + "ê±´";

            const breakdownList = document.getElementById('stat-product-breakdown');
            breakdownList.innerHTML = "";
            for (const [name, count] of Object.entries(productCounts)) {
                const li = document.createElement('li');
                li.style.padding = "5px 0";
                li.style.borderBottom = "1px solid #eee";
                li.innerHTML = `<span>${name}</span> <span style="float:right; font-weight:bold;">${count}ê°œ</span>`;
                breakdownList.appendChild(li);
            }
        }

        // [ê¸°ëŠ¥ 4] ìƒí’ˆ ì¶”ê°€ ë° ìˆ˜ì • ì²˜ë¦¬ (CRUD: Create & Update)
        document.getElementById('add-product-form').addEventListener('submit', async (e) => {
            e.preventDefault();
            const id = document.getElementById('edit-prod-id').value; 
            
            // ê¸°ë³¸ ì •ë³´
            const name = document.getElementById('new-prod-name').value;
            const price = Number(document.getElementById('new-prod-price').value);
            const salePrice = document.getElementById('new-prod-sale-price').value ? 
                             Number(document.getElementById('new-prod-sale-price').value) : null;
            const category = document.getElementById('new-prod-category').value;
            const stock = Number(document.getElementById('new-prod-stock').value) || 999;
            
            // ì´ë¯¸ì§€ ì •ë³´
            const img = document.getElementById('new-prod-img').value;
            const detailImgsText = document.getElementById('new-prod-detail-imgs').value;
            const detailImgs = detailImgsText ? detailImgsText.split('\n').filter(url => url.trim()) : [];
            
            // ìƒì„¸ ì„¤ëª…
            const summary = document.getElementById('new-prod-summary').value;
            const description = document.getElementById('new-prod-description').value;
            
            // ì¶”ê°€ ì˜µì…˜
            const isBestseller = document.getElementById('new-prod-bestseller').checked;
            const isNew = document.getElementById('new-prod-new').checked;
            const tagsText = document.getElementById('new-prod-tags').value;
            const tags = tagsText ? tagsText.split(',').map(tag => tag.trim()).filter(tag => tag) : [];
            
            const productData = {
                name,
                price,
                salePrice,
                category,
                stock,
                img,
                detailImgs,
                summary,
                description,
                isBestseller,
                isNew,
                tags
            };

            try {
                if (id) {
                    await updateDoc(doc(db, 'products', id), productData);
                    alert("ìƒí’ˆì´ ìˆ˜ì •ë˜ì—ˆìŠµë‹ˆë‹¤!");
                    cancelEdit(); 
                } else {
                    await addDoc(collection(db, 'products'), {
                        ...productData, 
                        createdAt: serverTimestamp()
                    });
                    alert("ìƒˆ ìƒí’ˆì´ ë“±ë¡ë˜ì—ˆìŠµë‹ˆë‹¤!");
                    e.target.reset();
                }
            } catch (err) {
                console.error(err);
                alert("ì²˜ë¦¬ ì‹¤íŒ¨: " + err.message);
            }
        });

        // [ê¸°ëŠ¥ 5] ìƒí’ˆ ì‚­ì œ (CRUD: Delete)
        window.deleteProduct = async (id) => {
            if(!confirm("ì •ë§ ì´ ìƒí’ˆì„ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?")) return;
            try {
                await deleteDoc(doc(db, 'products', id));
            } catch(err) {
                console.error(err);
                alert("ì‚­ì œ ì‹¤íŒ¨: " + err.message);
            }
        };

        // [ê¸°ëŠ¥ 6] ì£¼ë¬¸ ì œì¶œ
        document.getElementById('order-form').addEventListener('submit', async (e) => {
            e.preventDefault();
            if (!currentUser) return alert("ì´ˆê¸°í™” ì¤‘...");
            if (cart.length === 0) return alert("ì¥ë°”êµ¬ë‹ˆê°€ ë¹„ì–´ìˆìŠµë‹ˆë‹¤.");
            
            const btn = document.getElementById('btn-order-submit');
            btn.disabled = true; btn.innerText = "ì²˜ë¦¬ ì¤‘...";

            const userName = document.getElementById('user-name').value;
            const userPhone = document.getElementById('user-phone').value;
            const userAddress = document.getElementById('user-address').value;
            const depositName = document.getElementById('deposit-name').value;

            try {
                // ì¥ë°”êµ¬ë‹ˆì˜ ê° ìƒí’ˆì„ ê°œë³„ ì£¼ë¬¸ìœ¼ë¡œ ë“±ë¡
                const orderPromises = cart.map(item => {
                    const orderData = {
                        productName: item.name,
                        option: item.option,
                        qty: item.qty,
                        totalPrice: item.price * item.qty,
                        userName: userName,
                        userPhone: userPhone,
                        userAddress: userAddress,
                        depositName: depositName,
                        orderDate: serverTimestamp(),
                        status: "ì…ê¸ˆëŒ€ê¸°"
                    };
                    return addDoc(collection(db, 'orders'), orderData);
                });

                await Promise.all(orderPromises);
                
                // ì´ ê²°ì œ ê¸ˆì•¡ ê³„ì‚°
                const totalAmount = cart.reduce((sum, item) => sum + (item.price * item.qty), 0);
                document.getElementById('final-price').innerText = totalAmount.toLocaleString();
                
                // ì¥ë°”êµ¬ë‹ˆ ë¹„ìš°ê¸°
                cart = [];
                updateCartUI();
                
                switchView('success-page');
                e.target.reset();
            } catch(err) { 
                alert("ì£¼ë¬¸ ì‹¤íŒ¨: " + err.message); 
            }
            finally { 
                btn.disabled = false; 
                btn.innerText = "ì£¼ë¬¸ ì™„ë£Œí•˜ê¸°"; 
            }
        });

        // [ê¸°ëŠ¥ 7] ì£¼ë¬¸ ë°°ì†¡ ì²˜ë¦¬
        window.updateOrderStatus = async (docId) => {
            if(!confirm("ë°°ì†¡ ì™„ë£Œ ì²˜ë¦¬í•˜ì‹œê² ìŠµë‹ˆê¹Œ?")) return;
            await updateDoc(doc(db, 'orders', docId), { status: "ë°°ì†¡ì™„ë£Œ" });
        };
    </script>
</body>
</html>
